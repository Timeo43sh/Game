<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçå Banana Clicker - Emoji Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #FF2D75;
            --secondary: #2B2B36;
            --dark: #1A1A23;
            --light: #F0F0F0;
            --accent: #00D1FF;
            --success: #4CAF50;
            --warning: #FFC107;
            --danger: #F44336;
            --card-bg: #242430;
            --text: #FFFFFF;
            --text-secondary: #B0B0B0;
            --golden: #FFD700;
            --prestige: #9C27B0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--dark);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Styles pour Banana Clicker */
        #banana-clicker-game {
            text-align: center;
        }

        #banana {
            width: 220px;
            height: 220px;
            cursor: pointer;
            background-image: none;
            background-color: transparent;
            background-size: contain;
            background-repeat: no-repeat;
            transition: transform 0.1s;
            filter: drop-shadow(0 10px 20px rgba(255,160,0,0.6));
            margin: 0 auto 20px;
            font-size: 180px;
            line-height: 220px;
            user-select: none;
            animation: bounce 2s infinite ease-in-out;
        }

        #banana:active {
            transform: scale(0.85);
            animation-play-state: paused;
        }

        #banana::after {
            content: "üçå";
            display: inline-block;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-20px) scale(1.05); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .click-effect {
            position: absolute;
            font-size: 1.8rem;
            animation: floatAway 1.5s forwards;
            z-index: 100;
            pointer-events: none;
            font-weight: 700;
            text-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .click-effect.special {
            animation: floatAway 1.5s forwards, pulse 0.5s infinite alternate;
            z-index: 101;
            font-size: 2.2rem;
            font-weight: 900;
            text-shadow: 0 0 10px gold;
        }

        @keyframes floatAway {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-100px) rotate(20deg); opacity: 0; }
        }

        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.2); }
        }

        #banana-counter {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--warning);
        }

        #banana-bps {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .banana-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .banana-upgrades {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .banana-upgrade {
            background: var(--secondary);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--warning);
        }

        .banana-upgrade.new {
            border-left: 4px solid var(--prestige);
            animation: pulse 2s infinite alternate;
            position: relative;
            overflow: hidden;
        }

        .banana-upgrade.new::after {
            content: 'Nouveau!';
            position: absolute;
            top: 10px;
            right: -30px;
            background: var(--prestige);
            color: white;
            padding: 3px 30px;
            font-size: 0.75rem;
            transform: rotate(45deg);
        }

        .banana-upgrade-title {
            font-size: 1.1rem;
            margin-bottom: 8px;
            color: var(--accent);
        }

        .banana-upgrade-desc {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .banana-upgrade-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .banana-upgrade-cost {
            color: var(--primary);
            font-weight: 600;
        }

        .banana-upgrade-owned {
            color: var(--success);
        }

        .banana-btn {
            background: var(--warning);
            color: var(--dark);
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            font-weight: 600;
            width: 100%;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .banana-btn:hover {
            transform: translateY(-2px);
        }

        .banana-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .banana-tab-buttons {
            display: flex;
            border-bottom: 2px solid var(--secondary);
            margin-bottom: 20px;
        }

        .banana-tab-btn {
            padding: 10px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-secondary);
            position: relative;
        }

        .banana-tab-btn.active {
            color: var(--accent);
        }

        .banana-tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--accent);
        }

        .banana-tab-content {
            display: none;
        }

        .banana-tab-content.active {
            display: block;
        }

        .prestige-section {
            background: rgba(156, 39, 176, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 1px solid var(--prestige);
        }

        .prestige-btn {
            background: var(--prestige);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
            width: 100%;
        }

        .prestige-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .prestige-info {
            margin-bottom: 15px;
        }

        .golden-banana {
            color: var(--golden);
            font-weight: 600;
        }

        /* Styles pour le syst√®me de rebirth */
        .rebirth-progress {
            margin: 15px 0;
        }

        .progress-container {
            width: 100%;
            height: 20px;
            background-color: var(--secondary);
            border-radius: 10px;
            margin: 15px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--accent);
            width: 0%;
            transition: width 0.5s ease-in-out;
        }

        /* Styles pour les diff√©rents fruits */
        .fruit-strawberry::after {
            content: "üçì" !important;
        }
        
        .fruit-peach::after {
            content: "üçë" !important;
        }
        
        .fruit-meat::after {
            content: "ü•©" !important;
        }

        .achievement-notification {
            display: flex;
            align-items: center;
        }

        /* Styles pour les notifications */
        .game-notification {
            position: fixed;
            padding: 15px 20px;
            background: var(--accent);
            color: var(--dark);
            text-align: center;
            font-weight: 600;
            bottom: 70px;
            left: 50%;
            transform: translateX(-50%) translateY(100%);
            right: auto;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            width: 320px;
            z-index: 1000;
            transition: transform 0.4s ease, opacity 0.4s ease;
            opacity: 0;
        }
        
        .game-notification.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
        
        /* Styles pour les statistiques */
        .banana-stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-item {
            background: var(--secondary);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-label {
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent);
        }
        
        .banana-btn.can-afford {
            background: var(--primary);
            color: white;
        }
        
        /* Styles pour le syst√®me de codes */
        .code-section {
            background: var(--secondary);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .code-input {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .code-input input {
            flex: 1;
            padding: 10px 15px;
            border-radius: 5px;
            border: none;
            background: var(--dark);
            color: var(--text);
            font-family: 'Poppins', sans-serif;
        }
        
        .code-input button {
            background: var(--accent);
            color: var(--dark);
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .code-history {
            margin-top: 20px;
        }
        
        .code-history h4 {
            margin-bottom: 10px;
            color: var(--text-secondary);
        }
        
        .code-list {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            padding: 10px;
            max-height: 150px;
            overflow-y: auto;
        }
        
        .code-item {
            padding: 5px 10px;
            border-radius: 3px;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
        }
        
        .code-item.success {
            background: rgba(76, 175, 80, 0.2);
        }
        
        .code-item.error {
            background: rgba(244, 67, 54, 0.2);
        }
        
        /* Effet de pulsation sur la banane */
        #banana {
            animation: float 4s infinite ease-in-out;
        }
        
        /* Animation am√©lior√©e pour les clics */
        .click-effect {
            animation: floatAway 1.5s forwards;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(20deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="banana-clicker-game">
            <div id="banana-counter">0 bananes</div>
            <div id="banana-bps">0 bananes/seconde</div>
            <div id="banana-container">
                <div id="banana" title="Cliquez pour gagner des bananes!"></div>
            </div>
                
            <div class="banana-stats">
                <div class="stat-box">
                    <div class="stat-label">Total clics</div>
                    <div class="stat-value" id="banana-total-clicks">0</div>
                </div>
            </div>

            <div class="banana-tab-buttons">
                <button class="banana-tab-btn active" onclick="openBananaTab('upgrades')">Am√©liorations</button>
                <button class="banana-tab-btn" onclick="openBananaTab('prestige')">Prestige</button>
                <button class="banana-tab-btn" onclick="openBananaTab('codes')">Codes</button>
            </div>
            
            <div id="banana-upgrades-tab" class="banana-tab-content active">
                <h3>Am√©liorations de production</h3>
                <div class="banana-upgrades" id="banana-upgrades-container">
                    <!-- Les am√©liorations seront ajout√©es dynamiquement -->
                </div>
                
                <h3 style="margin-top: 20px;">Am√©liorations sp√©ciales</h3>
                <div class="banana-upgrades" id="banana-special-upgrades-container">
                    <!-- Les am√©liorations sp√©ciales seront ajout√©es dynamiquement -->
                </div>
            </div>
            
            <div id="banana-prestige-tab" class="banana-tab-content">
                <div class="prestige-section">
                    <h3>Syst√®me de Rebirth</h3>
                    <div id="current-fruit" style="font-size: 3rem; margin: 10px 0; text-align: center;">üçå</div>
                    <p class="prestige-info">
                        Effectuez un rebirth pour r√©initialiser votre progression et passer au fruit suivant!
                    </p>
                    <div class="rebirth-progress">
                        <p id="rebirth-requirement">Banane: Vous avez besoin d'au moins 1,000,000 bananes pour effectuer un rebirth.</p>
                        <p id="rebirth-unlocks">Am√©liorations disponibles: Singe Assistant √† Galaxie</p>
                        <div class="progress-container">
                            <div class="progress-bar" id="rebirth-progress-bar"></div>
                        </div>
                    </div>
                    <button class="prestige-btn" id="rebirth-btn" disabled>REBIRTH</button>
                </div>
            </div>
            
            <div id="banana-codes-tab" class="banana-tab-content">
                <div class="code-section">
                    <h3>Codes Secrets</h3>
                    <p>Entrez un code secret pour recevoir des bananes instantan√©ment!</p>
                    
                    <div class="code-input">
                        <input type="text" id="code-input" placeholder="Entrez votre code ici...">
                        <button id="code-submit-btn">Valider</button>
                    </div>
                    
                    <div class="code-history">
                        <h4>Historique des codes utilis√©s</h4>
                        <div class="code-list" id="code-history-list">
                            <!-- Les codes utilis√©s seront ajout√©s ici dynamiquement -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <audio id="clickSound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3"></audio>
    <audio id="upgradeSound" src="https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3"></audio>
    <audio id="specialSound" src="https://assets.mixkit.co/sfx/preview/mixkit-extra-bonus-in-a-video-game-2045.mp3"></audio>
    <audio id="prestigeSound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3"></audio>
    
    <script>
        // Jeu Banana Clicker
        function initBananaClicker() {
            // Variables du jeu
            let gameState = {
                bananas: 0,
                totalClicks: 0,
                bananasPerSecond: 0,
                multiplier: 1,
                upgrades: {},
                achievements: {}, // Suivi des succ√®s d√©bloqu√©s
                stats: {
                    totalBananasEarned: 0,
                    totalPrestigesPerformed: 0,
                    bestBananaPerSecond: 0,
                    biggestCriticalClick: 0,
                    blockedClicks: 0 // Clics bloqu√©s par l'anti-autoclicker
                },
                lastUpdate: Date.now(),
                lastClickTime: 0, // Pour l'anti-autoclicker
                temporaryClickBonus: null, // Pour l'√©v√©nement 'click-frenzy'
                rebirthLevel: 0, // Nouveau: niveau de rebirth (0 = banane, 1 = fraise, 2 = p√™che, 3 = c√¥te de porc)
                currentFruit: 'üçå', // √âmoji du fruit actuel
                rebirthPoints: 0, // Points accumul√©s par rebirth
                usedCodes: [] // Codes d√©j√† utilis√©s
            };
            
            // Am√©liorations disponibles
            const upgrades = [
                { 
                    id: 'monkey', 
                    name: 'Singe Assistant', 
                    description: 'On a tous la blague', 
                    baseCost: 500, 
                    bps: 0.1,
                    icon: 'fas fa-paw'
                },
                { 
                    id: 'farm', 
                    name: 'Ferme Banani√®re', 
                    description: 'Une plantation de bananes basique avec deux coups de fouets quand m√™me', 
                    baseCost: 1000, 
                    bps: 0.5,
                    icon: 'fas fa-tractor'
                },
                { 
                    id: 'factory', 
                    name: 'Usine de Bananes', 
                    description: 'Une histoire de famille', 
                    baseCost: 5000, 
                    bps: 1,
                    icon: 'fas fa-industry'
                },
                { 
                    id: 'plantation', 
                    name: 'Plantation G√©ante', 
                    description: 'Maintenant ils ont le droit d acheter des esclaves ?', 
                    baseCost: 10000, 
                    bps: 5,
                    icon: 'fas fa-globe-americas'
                },
                { 
                    id: 'research', 
                    name: 'Laboratoire de Recherche', 
                    description: 'Three hundred bl*ck men for only.......', 
                    baseCost: 50000, 
                    bps: 10,
                    icon: 'fas fa-flask'
                },
                { 
                    id: 'portal', 
                    name: 'La tortue', 
                    description: 'Tu as du mal √† voir l ecran avance, ta t√™te comme Franklin Prime', 
                    baseCost: 100000, 
                    bps: 15,
                    icon: 'fas fa-door-open'
                },
                
                { 
                    id: 'timetravel', 
                    name: 'Machine √† Voyager dans le Temps', 
                    description: 'POV, tu roules en Peugeot 1007, tu casses une suspension, tu d√©cides de remonter le temps pour manger un giga tacos taille XXXXXL', 
                    baseCost: 1000000, 
                    bps: 100,
                    icon: 'fas fa-clock'
                },
                { 
                    id: 'galaxy', 
                    name: 'La Galaxie', 
                    description: 'Ton ventre est un trou noir, Tu fait 1m ta fait ton sport du mois tu doit certainement √™tre..... ', 
                    baseCost: 5000000, 
                    bps: 250,
                    icon: 'fas fa-star'
                },
           
                { 
                    id: 'cisco', 
                    name: 'Cisco Paquet Tracer', 
                    description: 'Tu te branle sur la fibre, tu fais du speedtest, tu d√©cide de mettre un paquet tracer ', 
                    baseCost: 10000000, 
                    bps: 500,
                    icon: 'fas fa-network-wired'
                },
                { 
                    id: 'Essaie', 
                    name: 'Essaie', 
                    description: 'Imagine tu fais un essaie en fran√ßais et tu ose √©crire 37 lignes ', 
                    baseCost: 37000000, 
                    bps: 1000,
                    icon: 'fas fa-pencil-alt'
                },
                { 
                    id: 'inflation', 
                    name: 'L inflation', 
                    description: 'L√†, tu es dans la merde donc tu d√©cide d augmenter le SMIC ', 
                    baseCost: 100000000, 
                    bps: 2000,
                    icon: 'fas fa-chart-line'
                },
                { 
                    id: 'viande', 
                    name: 'Banana Viande', 
                    description: 'Tu connais la blague mais le score fiscal est pas bon (E) ', 
                    baseCost: 250000000, 
                    bps: 3000,
                    icon: 'fas fa-drumstick-bite'
                },
                { 
                    id: 'KFC', 
                    name: 'Le Poulet', 
                    description: 'Maintenant que tu as percer dans les bananes tu d√©cide de partir dans une autre de tes cultures. ', 
                    baseCost: 500000000, 
                    bps: 5000,
                    icon: 'fas fa-feather'
                },
                { 
                    id: 'naj', 
                    name: 'Hobbies', 
                    description: 'La Natation et le v√©lo, mdr tu vide l eau de la piscine et tu d√©truit des suspension', 
                    baseCost: 1000000000, 
                    bps: 10000,
                    icon: 'fas fa-swimming-pool'
                },
                { 
                    id: 'chomeur', 
                    name: 'Chomeur de merde', 
                    description: 'La gros ta vraiment pas de vie', 
                    baseCost: 5000000000, 
                    bps: 100000,
                    icon: 'fas fa-bed'
                },
                { 
                    id: 'data', 
                    name: 'Le data center SQL MariaDB', 
                    description: 'Quand tu respire il y √† plus d air, tu frotte tes cuisses, tu mange pour 6, qui suis-je ?', 
                    baseCost: 100000000000, 
                    bps: 1000000,
                    icon: 'fas fa-database'
                },
                { 
                    id: 'Pierre', 
                    name: 'Le Caillou', 
                    description: 'Ecoute moi bien grosse merde je te d√©teste a farme autant', 
                    baseCost: 100000000000000, 
                    bps: 1000000,
                    icon: 'fas fa-gem'
                },
            ];
            
            // Am√©liorations sp√©ciales
            const specialUpgrades = [
                {
                    id: 'click-power',
                    name: 'Puissance de Clic',
                    description: 'Double occasionnellement les bananes gagn√©es par clic',
                    baseCost: 5000,
                    maxLevel: 5,
                    icon: 'fas fa-bolt'
                },
                {
                    id: 'auto-click',
                    name: 'Auto-Clicker',
                    description: 'Clique automatiquement toutes les 10 secondes',
                    baseCost: 15000,
                    maxLevel: 5,
                    icon: 'fas fa-mouse-pointer'
                }
            ];
            
            // Succ√®s modifi√©s sans r√©f√©rence aux bananes dor√©es
            const achievements = [
                {
                    id: 'first-banana',
                    name: 'Premi√®re Banane',
                    description: 'Cliquez pour obtenir votre premi√®re banane',
                    condition: () => gameState.totalClicks >= 1,
                    reward: 'Une banane de bienvenue!',
                    icon: 'fas fa-hand-point-up'
                },
                {
                    id: 'banana-addict',
                    name: 'Accro aux Bananes',
                    description: 'Cliquez 100 fois',
                    condition: () => gameState.totalClicks >= 100,
                    reward: '+10 bananes gratuites!',
                    icon: 'fas fa-hand-rock',
                    effect: () => { gameState.bananas += 10; }
                },
                {
                    id: 'banana-master',
                    name: 'Ma√Ætre des Bananes',
                    description: 'Cliquez 1,000 fois',
                    condition: () => gameState.totalClicks >= 1000,
                    reward: '+100 bananes gratuites!',
                    icon: 'fas fa-crown',
                    effect: () => { gameState.bananas += 100; }
                },
                {
                    id: 'banana-king',
                    name: 'Roi des Bananes',
                    description: 'Atteignez 1 million de bananes',
                    condition: () => gameState.bananas >= 1000000,
                    reward: 'D√©bloquez le prestige!',
                    icon: 'fas fa-chess-king'
                },
                {
                    id: 'upgrade-enthusiast',
                    name: 'Passionn√© d\'Am√©liorations',
                    description: 'Achetez un total de 50 am√©liorations',
                    condition: () => {
                        let totalUpgrades = 0;
                        for (let id in gameState.upgrades) {
                            if (gameState.upgrades[id].owned) {
                                totalUpgrades += gameState.upgrades[id].owned;
                            }
                        }
                        return totalUpgrades >= 50;
                    },
                    reward: 'R√©duction de 5% sur tous les achats futurs',
                    icon: 'fas fa-arrow-circle-up',
                    effect: () => { gameState.discountMultiplier = 0.95; }
                }
            ];
            
            // √âl√©ments du DOM
            const bananaElement = document.getElementById('banana');
            const bananaCounter = document.getElementById('banana-counter');
            const bananaBps = document.getElementById('banana-bps');
            const totalClicksElement = document.getElementById('banana-total-clicks');
            const upgradesContainer = document.getElementById('banana-upgrades-container');
            const specialUpgradesContainer = document.getElementById('banana-special-upgrades-container');
            const prestigeBtn = document.getElementById('rebirth-btn');
            const prestigeRequirement = document.getElementById('rebirth-requirement');
            const prestigeReward = document.getElementById('rebirth-unlocks');
            
            // Charger la sauvegarde
            function loadSave() {
                const save = localStorage.getItem('bananaClickerSave');
                if (save) {
                    const data = JSON.parse(save);
                    gameState = {
                        ...gameState,
                        ...data,
                        lastUpdate: Date.now()
                    };
                    
                    // Mise √† jour des BPS apr√®s chargement
                    updateBananasPerSecond();
                    updateDisplay();
                }
            }
            
            // Sauvegarder le jeu
            function saveGame() {
                localStorage.setItem('bananaClickerSave', JSON.stringify({
                    ...gameState,
                    lastUpdate: Date.now()
                }));
            }
            
            // Sauvegarder p√©riodiquement et avant de quitter
            setInterval(saveGame, 30000);
            window.addEventListener('beforeunload', saveGame);
            
            // Mettre √† jour l'affichage
            function updateDisplay() {
                bananaCounter.textContent = `${formatNumber(gameState.bananas)} bananes`;
                bananaBps.textContent = `${gameState.bananasPerSecond.toFixed(1)} bananes/seconde`;
                totalClicksElement.textContent = gameState.totalClicks;
                
                // Mettre √† jour les boutons d'am√©lioration
                upgrades.forEach(upgrade => {
                    const btn = document.getElementById(`${upgrade.id}-btn`);
                    if (btn) {
                        const cost = getUpgradeCost(upgrade);
                        btn.disabled = gameState.bananas < cost;
                    }
                });
                
                // Mettre √† jour les boutons d'am√©liorations sp√©ciales
                specialUpgrades.forEach(upgrade => {
                    const btn = document.getElementById(`special-${upgrade.id}-btn`);
                    if (btn) {
                        const cost = getSpecialUpgradeCost(upgrade);
                        const level = gameState.upgrades[upgrade.id]?.level || 0;
                        btn.disabled = gameState.bananas < cost || level >= upgrade.maxLevel;
                        btn.textContent = level >= upgrade.maxLevel ? 'MAX' : `Am√©liorer (${formatNumber(cost)})`;
                    }
                });
                
                // Mettre √† jour l'interface de rebirth
                updateRebirthUI();
            }
            
            // Formater les grands nombres
            function formatNumber(num) {
                if (num >= 1000000000) {
                    return (num / 1000000000).toFixed(1) + 'B';
                }
                if (num >= 1000000) {
                    return (num / 1000000).toFixed(1) + 'M';
                }
                if (num >= 1000) {
                    return (num / 1000).toFixed(1) + 'K';
                }
                return Math.floor(num).toString();
            }
            
            // Calculer le co√ªt d'une am√©lioration
            function getUpgradeCost(upgrade) {
                const owned = gameState.upgrades[upgrade.id]?.owned || 0;
                let cost = Math.floor(upgrade.baseCost * Math.pow(1.15, owned));
                
                // Appliquer une r√©duction si le succ√®s correspondant est d√©bloqu√©
                if (gameState.discountMultiplier) {
                    cost = Math.floor(cost * gameState.discountMultiplier);
                }
                
                return cost;
            }
            
            // Calculer le co√ªt d'une am√©lioration sp√©ciale
            function getSpecialUpgradeCost(upgrade) {
                const level = gameState.upgrades[upgrade.id]?.level || 0;
                let cost = upgrade.baseCost * Math.pow(2, level);
                
                // Appliquer une r√©duction si le succ√®s correspondant est d√©bloqu√©
                if (gameState.discountMultiplier) {
                    cost = Math.floor(cost * gameState.discountMultiplier);
                }
                
                return cost;
            }
            
            // Mettre √† jour les bananes par seconde
            function updateBananasPerSecond() {
                let bps = upgrades.reduce((total, upgrade) => {
                    const owned = gameState.upgrades[upgrade.id]?.owned || 0;
                    return total + (upgrade.bps * owned);
                }, 0);
                
                gameState.bananasPerSecond = bps;
                
                // Mettre √† jour les statistiques
                if (bps > gameState.stats.bestBananaPerSecond) {
                    gameState.stats.bestBananaPerSecond = bps;
                }
            }
            
            // G√©rer le clic sur la banane
            function handleBananaClick() {
                // Anti-autoclicker: v√©rifier l'intervalle minimum entre les clics (100ms)
                const now = Date.now();
                if (now - gameState.lastClickTime < 100) {
                    // Ignorer les clics trop rapides et compter silencieusement
                    gameState.stats.blockedClicks++;
                    return;
                }
                
                // Mettre √† jour le timestamp du dernier clic
                gameState.lastClickTime = now;
                
                // Gain fixe de 1 banane par clic ou bonus temporaire si actif
                let gain = gameState.temporaryClickBonus || 1;
                let isCritical = false;
                
                // Chance de coup critique
                const clickPowerLevel = gameState.upgrades['click-power']?.level || 0;
                if (clickPowerLevel > 0 && Math.random() < 0.1 * clickPowerLevel) {
                    gain *= 2;
                    isCritical = true;
                    
                    // Mettre √† jour les statistiques
                    if (gain > gameState.stats.biggestCriticalClick) {
                        gameState.stats.biggestCriticalClick = gain;
                    }
                    
                    // Effet sp√©cial
                    const clickEffect = document.createElement('div');
                    clickEffect.className = 'click-effect special';
                    clickEffect.textContent = `CRITIQUE! +${gain}`;
                    clickEffect.style.left = `${Math.random() * 100 + 50}px`;
                    clickEffect.style.color = 'gold';
                    document.getElementById('banana-container').appendChild(clickEffect);
                    
                    setTimeout(() => {
                        clickEffect.remove();
                    }, 2000);
                    
                    playSound(specialSound);
                } else {
                    // Effet normal
                    const clickEffect = document.createElement('div');
                    clickEffect.className = 'click-effect';
                    clickEffect.textContent = `+${gain}`;
                    clickEffect.style.left = `${Math.random() * 100 + 50}px`;
                    clickEffect.style.color = `hsl(${Math.random() * 60 + 30}, 100%, 50%)`;
                    document.getElementById('banana-container').appendChild(clickEffect);
                    
                    setTimeout(() => {
                        clickEffect.remove();
                    }, 1500);
                    
                    playSound(clickSound);
                }
                
                // Animation de pulsation sur la banane
                bananaElement.style.transform = 'scale(0.92)';
                setTimeout(() => {
                    bananaElement.style.transform = 'scale(1)';
                }, 100);
                
                gameState.bananas += gain;
                gameState.totalClicks++;
                gameState.stats.totalBananasEarned += gain;
                
                updateDisplay();
                saveGame();
            }
            
            // Acheter une am√©lioration
            function buyUpgrade(upgradeId) {
                const upgrade = upgrades.find(u => u.id === upgradeId);
                if (!upgrade) return;
                
                const cost = getUpgradeCost(upgrade);
                
                if (gameState.bananas >= cost) {
                    gameState.bananas -= cost;
                    
                    if (!gameState.upgrades[upgrade.id]) {
                        gameState.upgrades[upgrade.id] = { owned: 0 };
                    }
                    
                    gameState.upgrades[upgrade.id].owned++;
                    
                    updateBananasPerSecond();
                    updateDisplay();
                    saveGame();
                    playSound(upgradeSound);
                }
            }
            
            // Acheter une am√©lioration sp√©ciale
            function buySpecialUpgrade(upgradeId) {
                const upgrade = specialUpgrades.find(u => u.id === upgradeId);
                if (!upgrade) return;
                
                const cost = getSpecialUpgradeCost(upgrade);
                const level = gameState.upgrades[upgrade.id]?.level || 0;
                
                if (level >= upgrade.maxLevel) return;
                
                if (gameState.bananas >= cost) {
                    gameState.bananas -= cost;
                    
                    if (!gameState.upgrades[upgrade.id]) {
                        gameState.upgrades[upgrade.id] = { level: 0 };
                    }
                    
                    gameState.upgrades[upgrade.id].level++;
                    
                    updateDisplay();
                    saveGame();
                    playSound(upgradeSound);
                }
            }
            
            // Effectuer un rebirth
            function rebirth() {
                // V√©rifier les conditions selon le niveau de rebirth
                let canRebirth = false;
                let rebirthRequirement = 0;
                
                switch (gameState.rebirthLevel) {
                    case 0: // Banane -> Fraise
                        rebirthRequirement = 1000000; // 1M
                        canRebirth = gameState.bananas >= rebirthRequirement;
                        break;
                    case 1: // Fraise -> P√™che
                        rebirthRequirement = 150000000; // 150M
                        canRebirth = gameState.bananas >= rebirthRequirement;
                        break;
                    case 2: // P√™che -> C√¥te de porc
                        rebirthRequirement = 1000000000; // 1B
                        canRebirth = gameState.bananas >= rebirthRequirement;
                        break;
                    case 3: // C√¥te de porc -> Recommencer le cycle
                        rebirthRequirement = 100000000000000; // 100000B
                        canRebirth = gameState.bananas >= rebirthRequirement;
                        break;
                }

                if (!canRebirth) return;
                
                const nextFruits = ['üçì', 'üçë', 'ü•©', 'üçå'];
                const fruitNames = ['Fraise', 'P√™che', 'C√¥te de porc', 'Banane'];
                const confirmMessage = gameState.rebirthLevel === 3 
                    ? `Voulez-vous vraiment recommencer le cycle complet? Vous perdrez toutes vos bananes et am√©liorations.`
                    : `Voulez-vous vraiment passer √† la ${fruitNames[gameState.rebirthLevel]}? Vous perdrez toutes vos bananes et am√©liorations.`;
                
                if (confirm(confirmMessage)) {
                    // Obtenir les am√©liorations d√©bloqu√©es avant de changer de niveau
                    let newUnlocks = [];
                    const nextLevel = (gameState.rebirthLevel + 1) % 4;
                    switch (nextLevel) {
                        case 1: // Fraise
                            newUnlocks = ['Cisco Paquet Tracer', 'Essaie', 'L\'inflation'];
                            break;
                        case 2: // P√™che
                            newUnlocks = ['Banana Viande', 'Le Poulet'];
                            break;
                        case 3: // C√¥te de porc
                            newUnlocks = ['Hobbies', 'Chomeur de merde', 'Le data center SQL MariaDB', 'Le Caillou'];
                            break;
                        case 0: // Retour √† la Banane
                            newUnlocks = ['Toutes les am√©liorations sont r√©initialis√©es'];
                            break;
                    }
                    
                    // Augmenter le niveau de rebirth ou revenir √† 0 si on a termin√© le cycle
                    gameState.rebirthLevel = nextLevel;
                    gameState.currentFruit = nextFruits[gameState.rebirthLevel === 0 ? 3 : gameState.rebirthLevel - 1];
                    
                    // Mise √† jour des statistiques
                    gameState.stats.totalPrestigesPerformed++;
                    
                    // R√©initialiser le jeu
                    gameState.bananas = 0;
                    gameState.totalClicks = 0;
                    gameState.bananasPerSecond = 0;
                    gameState.upgrades = {};
                    
                    // Mettre √† jour l'affichage
                    updateRebirthUI();
                    updateBananasPerSecond();
                    updateDisplay();
                    saveGame();
                    playSound(prestigeSound);
                    
                    // Re-rendre les am√©liorations
                    renderUpgrades();
                    renderSpecialUpgrades();
                    
                    // Afficher un message de f√©licitations
                    showNotification(`Rebirth r√©ussi! Vous jouez maintenant avec ${fruitNames[gameState.rebirthLevel]}.`);
                    
                    // Afficher une notification pour les nouvelles am√©liorations d√©bloqu√©es
                    if (newUnlocks.length > 0) {
                        setTimeout(() => {
                            showNotification(`Nouvelles am√©liorations d√©bloqu√©es: ${newUnlocks.join(', ')}!`);
                        }, 2000);
                    }
                }
            }
            
            // Mettre √† jour l'interface de rebirth
            function updateRebirthUI() {
                const fruitNames = ['Banane', 'Fraise', 'P√™che', 'C√¥te de porc'];
                const fruitEmojis = ['üçå', 'üçì', 'üçë', 'ü•©'];
                const rebirthRequirements = [1000000, 150000000, 1000000000, 100000000000000];
                const unlockMessages = [
                    "Am√©liorations disponibles: Singe Assistant √† Galaxie",
                    "Am√©liorations disponibles: Singe Assistant √† Inflation",
                    "Am√©liorations disponibles: Singe Assistant √† Poulet",
                    "Am√©liorations disponibles: Singe Assistant √† Caillou"
                ];
                
                // Mise √† jour du texte de la condition
                const currentRequirement = rebirthRequirements[gameState.rebirthLevel];
                const canRebirth = gameState.bananas >= currentRequirement;
                
                prestigeBtn.disabled = !canRebirth;
                prestigeRequirement.textContent = canRebirth 
                    ? `Vous pouvez effectuer un rebirth!` 
                    : `${fruitNames[gameState.rebirthLevel]}: Vous avez besoin d'au moins ${formatNumber(currentRequirement)} bananes pour effectuer un rebirth.`;
                
                // Mise √† jour du message des r√©compenses de rebirth (am√©liorations d√©bloqu√©es)
                let nextRebirthLevel = (gameState.rebirthLevel + 1) % 4;
                let unlocksMessage = "";
                
                switch (nextRebirthLevel) {
                    case 0: // Red√©marrage complet
                        unlocksMessage = "Recommencer le cycle complet avec toutes les am√©liorations d√©bloqu√©es";
                        break;
                    case 1: // Fraise
                        unlocksMessage = "Nouvelles am√©liorations: Cisco, Essaie, Inflation";
                        break;
                    case 2: // P√™che
                        unlocksMessage = "Nouvelles am√©liorations: Viande, Poulet";
                        break;
                    case 3: // C√¥te de porc
                        unlocksMessage = "Toutes les am√©liorations d√©bloqu√©es jusqu'au Caillou";
                        break;
                }
                
                prestigeReward.textContent = unlocksMessage;
                
                // Mise √† jour de la barre de progression
                const progressBar = document.getElementById('rebirth-progress-bar');
                const progressPercentage = Math.min(100, (gameState.bananas / currentRequirement) * 100);
                progressBar.style.width = `${progressPercentage}%`;
                
                // Mise √† jour de l'ic√¥ne du fruit actuel
                document.getElementById('current-fruit').textContent = gameState.currentFruit;
                
                // Mise √† jour de la classe du fruit sur l'√©l√©ment banane
                bananaElement.className = '';
                switch (gameState.rebirthLevel) {
                    case 1:
                        bananaElement.classList.add('fruit-strawberry');
                        break;
                    case 2:
                        bananaElement.classList.add('fruit-peach');
                        break;
                    case 3:
                        bananaElement.classList.add('fruit-meat');
                        break;
                    default:
                        // Banane par d√©faut, ne rien ajouter
                        break;
                }
                
                // Mise √† jour du titre du jeu
                document.title = `${fruitEmojis[gameState.rebirthLevel]} ${fruitNames[gameState.rebirthLevel]} Clicker - Emoji Edition`;
                
                // Mise √† jour du compteur de bananes
                bananaCounter.textContent = `${formatNumber(gameState.bananas)} ${fruitNames[gameState.rebirthLevel].toLowerCase()}s`;
            }
            
            // G√©n√©rer les cartes d'am√©lioration
            function renderUpgrades() {
                upgradesContainer.innerHTML = '';
                
                // D√©terminer les am√©liorations disponibles selon le niveau de rebirth
                let availableUpgrades = [];
                
                // Nouvelles am√©liorations d√©bloqu√©es √† ce niveau de rebirth
                let newUnlocks = [];
                
                switch (gameState.rebirthLevel) {
                    case 0: // Banane - Jusqu'√† la galaxie
                        availableUpgrades = upgrades.filter(upgrade => 
                            ['monkey', 'farm', 'factory', 'plantation', 'research', 'portal', 'timetravel', 'galaxy'].includes(upgrade.id));
                        // Pas de nouvelles am√©liorations au niveau 0
                        break;
                    case 1: // Fraise - Jusqu'√† l'inflation
                        availableUpgrades = upgrades.filter(upgrade => 
                            ['monkey', 'farm', 'factory', 'plantation', 'research', 'portal', 'timetravel', 'galaxy', 
                            'cisco', 'Essaie', 'inflation'].includes(upgrade.id));
                        // Nouvelles am√©liorations d√©bloqu√©es √† ce niveau
                        newUnlocks = ['cisco', 'Essaie', 'inflation'];
                        break;
                    case 2: // P√™che - Jusqu'au poulet
                        availableUpgrades = upgrades.filter(upgrade => 
                            ['monkey', 'farm', 'factory', 'plantation', 'research', 'portal', 'timetravel', 'galaxy', 
                            'cisco', 'Essaie', 'inflation', 'viande', 'KFC'].includes(upgrade.id));
                        // Nouvelles am√©liorations d√©bloqu√©es √† ce niveau
                        newUnlocks = ['viande', 'KFC'];
                        break;
                    case 3: // C√¥te de porc - Jusqu'au caillou (toutes les am√©liorations)
                        availableUpgrades = upgrades;
                        // Nouvelles am√©liorations d√©bloqu√©es √† ce niveau
                        newUnlocks = ['naj', 'chomeur', 'data', 'Pierre'];
                        break;
                }
                
                availableUpgrades.forEach(upgrade => {
                    const owned = gameState.upgrades[upgrade.id]?.owned || 0;
                    const cost = getUpgradeCost(upgrade);
                    const canAfford = gameState.bananas >= cost;
                    const isNew = newUnlocks.includes(upgrade.id);
                    
                    const upgradeElement = document.createElement('div');
                    upgradeElement.className = `banana-upgrade ${isNew ? 'new' : ''}`;
                    upgradeElement.innerHTML = `
                        <h4 class="banana-upgrade-title"><i class="${upgrade.icon}"></i> ${upgrade.name}</h4>
                        <p class="banana-upgrade-desc">${upgrade.description}</p>
                        <div class="banana-upgrade-info">
                            <span class="banana-upgrade-cost">Co√ªt: ${formatNumber(cost)}</span>
                            <span class="banana-upgrade-owned">Poss√©d√©s: ${owned}</span>
                        </div>
                        <div class="banana-upgrade-info">
                            <span>Production: +${upgrade.bps}/s</span>
                            <span>Total: +${(upgrade.bps * owned).toFixed(1)}/s</span>
                        </div>
                        <button id="${upgrade.id}-btn" class="banana-btn ${canAfford ? 'can-afford' : ''}" onclick="buyBananaUpgrade('${upgrade.id}')" ${canAfford ? '' : 'disabled'}>
                            ${canAfford ? 'Acheter' : `Besoin de ${formatNumber(cost - gameState.bananas)} de plus`}
                        </button>
                    `;
                    
                    upgradesContainer.appendChild(upgradeElement);
                });
            }
            
            // G√©n√©rer les am√©liorations sp√©ciales
            function renderSpecialUpgrades() {
                specialUpgradesContainer.innerHTML = '';
                
                specialUpgrades.forEach(upgrade => {
                    const level = gameState.upgrades[upgrade.id]?.level || 0;
                    const cost = getSpecialUpgradeCost(upgrade);
                    const maxed = level >= upgrade.maxLevel;
                    const canAfford = gameState.bananas >= cost && !maxed;
                    
                    const upgradeElement = document.createElement('div');
                    upgradeElement.className = 'banana-upgrade';
                    upgradeElement.innerHTML = `
                        <h4 class="banana-upgrade-title"><i class="${upgrade.icon}"></i> ${upgrade.name} <small>Niv. ${level}/${upgrade.maxLevel}</small></h4>
                        <p class="banana-upgrade-desc">${upgrade.description}</p>
                        ${maxed ? `
                            <button class="banana-btn" disabled>MAX</button>
                        ` : `
                            <div class="banana-upgrade-info">
                                <span class="banana-upgrade-cost">Co√ªt: ${formatNumber(cost)}</span>
                            </div>
                            <button id="special-${upgrade.id}-btn" class="banana-btn ${canAfford ? 'can-afford' : ''}" onclick="buyBananaSpecialUpgrade('${upgrade.id}')" ${canAfford ? '' : 'disabled'}>
                                ${canAfford ? 'Am√©liorer' : `Besoin de ${formatNumber(cost - gameState.bananas)} de plus`}
                            </button>
                        `}
                    `;
                    
                    specialUpgradesContainer.appendChild(upgradeElement);
                });
            }
            
            // Afficher une notification g√©n√©rale
            function showNotification(message) {
                const notification = document.createElement('div');
                notification.className = 'game-notification';
                notification.textContent = message;
                
                document.body.appendChild(notification);
                
                // Animation d'entr√©e
                setTimeout(() => {
                    notification.classList.add('show');
                }, 100);
                
                // Supprimer apr√®s un d√©lai
                setTimeout(() => {
                    notification.classList.remove('show');
                    setTimeout(() => {
                        notification.remove();
                    }, 500);
                }, 3000);
            }
            
            // Fonction d'auto-clic bas√©e sur l'am√©lioration
            function handleAutoClick() {
                const autoClickLevel = gameState.upgrades['auto-click']?.level || 0;
                if (autoClickLevel > 0) {
                    // Simuler un clic toutes les 10 secondes, moins 1 seconde par niveau
                    const clickInterval = Math.max(1000, 10000 - (autoClickLevel * 1000));
                    
                    setInterval(() => {
                        // Gain fixe de 0.5 banane par auto-clic
                        let gain = 0.5;
                        gameState.bananas += gain;
                        gameState.stats.totalBananasEarned += gain;
                        
                        // Petit effet visuel
                        const clickEffect = document.createElement('div');
                        clickEffect.className = 'click-effect';
                        clickEffect.textContent = `AUTO +${gain.toFixed(1)}`;
                        clickEffect.style.left = `${Math.random() * 100 + 50}px`;
                        clickEffect.style.color = `hsl(200, 80%, 60%)`;
                        document.getElementById('banana-container').appendChild(clickEffect);
                        
                        setTimeout(() => {
                            clickEffect.remove();
                        }, 1500);
                        
                        updateDisplay();
                    }, clickInterval);
                }
            }
            
            // Syst√®me de codes secrets
            function initCodeSystem() {
                const codeInput = document.getElementById('code-input');
                const codeSubmitBtn = document.getElementById('code-submit-btn');
                const codeHistoryList = document.getElementById('code-history-list');
                
                // Liste des codes secrets valides
                const secretCodes = {
                    'MILLION': 1000000, // 1 million de bananes
                    'MILLIARD': 1000000000, // 1 milliard de bananes
                    'JVEUXDESBANANES': 5000, // 5000 bananes
                    'CHEATCODE': 100000, // 100000 bananes
                    'JEUSUPERTOP': 50000 // 50000 bananes
                };
                
                // Charger l'historique des codes utilis√©s
                function loadCodeHistory() {
                    codeHistoryList.innerHTML = '';
                    if (gameState.usedCodes && gameState.usedCodes.length > 0) {
                        gameState.usedCodes.forEach(codeEntry => {
                            const codeItem = document.createElement('div');
                            codeItem.className = `code-item ${codeEntry.success ? 'success' : 'error'}`;
                            codeItem.innerHTML = `
                                <span>${codeEntry.code}</span>
                                <span>${codeEntry.success ? `+${formatNumber(codeEntry.reward)} bananes` : 'Invalide'}</span>
                            `;
                            codeHistoryList.appendChild(codeItem);
                        });
                    }
                }
                
                // Ajouter un code √† l'historique
                function addToHistory(code, success, reward = 0) {
                    if (!gameState.usedCodes) {
                        gameState.usedCodes = [];
                    }
                    
                    gameState.usedCodes.push({
                        code,
                        success,
                        reward,
                        date: new Date().toISOString()
                    });
                    
                    // Limiter l'historique √† 10 codes
                    if (gameState.usedCodes.length > 10) {
                        gameState.usedCodes.shift();
                    }
                    
                    loadCodeHistory();
                    saveGame();
                }
                
                // Fonction pour valider un code
                function validateCode(code) {
                    // V√©rifier si le code est valide
                    const normalizedCode = code.trim().toUpperCase();
                    
                    // V√©rifier si le code a d√©j√† √©t√© utilis√©
                    const codeAlreadyUsed = gameState.usedCodes.some(entry => 
                        entry.code.toUpperCase() === normalizedCode && entry.success);
                    
                    if (codeAlreadyUsed) {
                        showNotification('Ce code a d√©j√† √©t√© utilis√©!');
                        addToHistory(normalizedCode, false);
                        return;
                    }
                    
                    // V√©rifier si le code existe dans la liste des codes secrets
                    if (secretCodes[normalizedCode]) {
                        const reward = secretCodes[normalizedCode];
                        gameState.bananas += reward;
                        gameState.stats.totalBananasEarned += reward;
                        
                        showNotification(`Code valid√©! +${formatNumber(reward)} bananes!`);
                        addToHistory(normalizedCode, true, reward);
                        updateDisplay();
                        playSound(specialSound);
                    } else {
                        showNotification('Code invalide!');
                        addToHistory(normalizedCode, false);
                    }
                }
                
                // √âv√©nement de clic sur le bouton de validation
                codeSubmitBtn.addEventListener('click', () => {
                    validateCode(codeInput.value);
                    codeInput.value = '';
                });
                
                // √âv√©nement d'appui sur Entr√©e dans le champ de saisie
                codeInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        validateCode(codeInput.value);
                        codeInput.value = '';
                    }
                });
                
                // Charger l'historique des codes au d√©marrage
                loadCodeHistory();
            }
            
            // Ajouter un onglet de statistiques
            function renderStats() {
                // Cr√©er ou obtenir le conteneur d'onglets
                let statsTab = document.getElementById('banana-stats-tab');
                if (!statsTab) {
                    statsTab = document.createElement('div');
                    statsTab.id = 'banana-stats-tab';
                    statsTab.className = 'banana-tab-content';
                    document.getElementById('banana-clicker-game').appendChild(statsTab);
                    
                    // Ajouter un bouton dans la barre d'onglets
                    const tabButton = document.createElement('button');
                    tabButton.className = 'banana-tab-btn';
                    tabButton.onclick = function() { openBananaTab('stats'); };
                    tabButton.innerHTML = '<i class="fas fa-chart-bar"></i> Statistiques';
                    document.querySelector('.banana-tab-buttons').appendChild(tabButton);
                }
                
                statsTab.innerHTML = '<h3>Statistiques du jeu</h3>';
                
                // Conteneur pour les statistiques
                const statsContainer = document.createElement('div');
                statsContainer.className = 'banana-stats-container';
                
                statsContainer.innerHTML = `
                    <div class="stat-item">
                        <div class="stat-label">Total de bananes gagn√©es</div>
                        <div class="stat-value">${formatNumber(gameState.stats.totalBananasEarned)}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Total de clics</div>
                        <div class="stat-value">${gameState.totalClicks}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Clics bloqu√©s (anti-auto)</div>
                        <div class="stat-value">${gameState.stats.blockedClicks || 0}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Total de prestiges</div>
                        <div class="stat-value">${gameState.stats.totalPrestigesPerformed}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Meilleure production/sec</div>
                        <div class="stat-value">${gameState.stats.bestBananaPerSecond.toFixed(1)}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Plus gros clic critique</div>
                        <div class="stat-value">${gameState.stats.biggestCriticalClick.toFixed(1)}</div>
                    </div>
                `;
                
                statsTab.appendChild(statsContainer);
            }
            
            // Initialiser le jeu
            function init() {
                // Charger la sauvegarde
                loadSave();
                
                // Mettre √† jour l'affichage
                updateDisplay();
                updateRebirthUI();
                
                // Rendre les am√©liorations
                renderUpgrades();
                renderSpecialUpgrades();
                
                // Initialiser le syst√®me de codes secrets
                initCodeSystem();
                
                // √âcouter les clics sur la banane
                bananaElement.addEventListener('click', handleBananaClick);
                
                // Activer l'auto-clic si l'am√©lioration est achet√©e
                handleAutoClick();
                
                // Ajouter l'√©couteur d'√©v√©nement pour le bouton de prestige
                document.getElementById('rebirth-btn').addEventListener('click', rebirth);
                
                // Mise √† jour continue
                setInterval(() => {
                    const now = Date.now();
                    const delta = (now - gameState.lastUpdate) / 1000;
                    gameState.lastUpdate = now;
                    
                    // Ajouter les bananes passives
                    if (gameState.bananasPerSecond > 0) {
                        gameState.bananas += gameState.bananasPerSecond * delta;
                        gameState.stats.totalBananasEarned += gameState.bananasPerSecond * delta;
                        updateDisplay();
                    }
                }, 100);
            }
            
            // Jouer un son
            function playSound(sound) {
                sound.currentTime = 0;
                sound.play().catch(e => console.log("Le son n'a pas pu √™tre jou√©:", e));
            }
            
            // Exposer les fonctions au scope global
            window.buyBananaUpgrade = buyUpgrade;
            window.buyBananaSpecialUpgrade = buySpecialUpgrade;
            window.prestigeBananaClicker = rebirth;
            window.openBananaTab = function(tabId) {
                document.querySelectorAll('#banana-clicker-game .banana-tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelectorAll('#banana-clicker-game .banana-tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                document.querySelector(`#banana-clicker-game .banana-tab-btn[onclick="openBananaTab('${tabId}')"]`).classList.add('active');
                document.getElementById(`banana-${tabId}-tab`).classList.add('active');
            };
            
            // Initialiser le jeu
            init();
            
            // V√©rifier le temps d'absence (gains hors ligne)
            const offlineTime = (Date.now() - gameState.lastUpdate) / 1000;
            if (offlineTime > 60 && gameState.bananasPerSecond > 0) {
                // Limiter les gains hors ligne √† 8 heures maximum
                const cappedTime = Math.min(offlineTime, 8 * 60 * 60);
                const offlineGains = gameState.bananasPerSecond * cappedTime * 0.5; // 50% d'efficacit√© hors ligne
                
                gameState.bananas += offlineGains;
                gameState.stats.totalBananasEarned += offlineGains;
                
                showNotification(`Bienvenue ! Vous avez gagn√© ${formatNumber(offlineGains)} bananes pendant votre absence.`);
            }
        }

        // Initialiser le jeu au chargement de la page
        window.onload = function() {
            initBananaClicker();
        };
    </script>
</body>
</html>